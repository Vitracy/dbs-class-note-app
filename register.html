<!-- Credit: faiz-dev, vitracy -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Note Keep</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.hugeicons.com/font/hgi-stroke-rounded.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" type="text/css" href="global.css">
</head>

<body>

  <form onsubmit="return tambahUser()">
    <div class="container">
      <i class="hgi hgi-stroke hgi-property-edit app-logo"></i>
      <h1 class="title">Get Started</h1>
      <p class="sub-title">Create a free account to save your notes and access them anywhere</p>


      <!-- input email -->
      <div class="input-group">
        <label for="">Email Address</label>
        <input class="input" id="input-email" type="email" placeholder="name@example.com" required>
        <i class="fa fa-envelope mail-icon" aria-hidden="true" onclick="document.getElementById('input-email').focus();"></i>
      </div>

      <!-- input password -->
      <div class="input-group">
        <label for="">Password</label>
        <input class="input" id="input-password" type="password" placeholder="Create password" required>
        <i class="fa fa-eye-slash eye-icon" id="toggle-password" onclick="togglePassword()"></i>
        <span class="not-valid" id="not-valid-password" ></span>
      </div>

      <div class="input-group">
        <label for="">Confirm Password</label>
        <input class="input" id="input-confirm-password" type="password" placeholder="Re-enter password" required>
        <i class="fa fa-eye-slash eye-icon" id="toggle-confirm-password" onclick="toggleConfirmPassword()"></i>
        <span class="not-valid" id="not-confirmed-password" >Password does not match!</span>
      </div>

      <button type="submit" class="btn-submit" id="btn-register" >Register</button>

      <p class="under-text">
        Already have an account? <a href="./index.html">Log in</a>
      </p>



    </div>
  </form>
  <script type="text/javascript">
    // let users = [];

    let inConfirmPassword = document.getElementById("input-confirm-password");
    let inPassword = document.getElementById("input-password");
    let btnRegister = document.getElementById("btn-register");

    function togglePassword() {
      let eyeIcon = document.getElementById("toggle-password");
      if(inPassword.type == 'password') {
        inPassword.type = 'text';
        eyeIcon.classList.remove('fa-eye-slash');
        eyeIcon.classList.add('fa-eye');
        inPassword.focus();
      }
      else {
        inPassword.type = 'password';
        eyeIcon.classList.remove('fa-eye');
        eyeIcon.classList.add('fa-eye-slash');
      }
    }

    function toggleConfirmPassword() {
      let eyeIcon = document.getElementById("toggle-confirm-password");
      if(inConfirmPassword.type == 'password') {
        inConfirmPassword.type = 'text';
        eyeIcon.classList.remove('fa-eye-slash');
        eyeIcon.classList.add('fa-eye');
        inConfirmPassword.focus();
      }
      else {
        inConfirmPassword.type = 'password';
        eyeIcon.classList.remove('fa-eye');
        eyeIcon.classList.add('fa-eye-slash');
      }
    }

    inConfirmPassword.oninput = function() {
      if (inConfirmPassword.value && inPassword.value != inConfirmPassword.value) {
        document.getElementById("not-confirmed-password").style.display = "block";
        btnRegister.style.opacity = 0.5;
      }
      else {
        document.getElementById("not-confirmed-password").style.display = "none";
        btnRegister.style.opacity = 1;
      }


    }

    inPassword.oninput = function() {
      updatePasswordValidate(inPassword.value);
    }

    function isValidPassword(password) {
      if (password)
      {
        // Validate lower case
        var lowerCaseLetters = /[a-z]/g;
        if(!password.match(lowerCaseLetters)) return false;
        
        // Validate capital letters
        var upperCaseLetters = /[A-Z]/g;
        if(!password.match(upperCaseLetters)) return false;

        // Validate numbers
        var numbers = /[0-9]/g;
        if(!password.match(numbers)) return false;
        
        // Validate length
        if(password.length < 6) return false;
      }

      return true;
    }

    function updatePasswordValidate(password) {
      
        var lowerCaseLetters = /[a-z]/g;
        var upperCaseLetters = /[A-Z]/g;
        var numbers = /[0-9]/g;

        if (password) {
          // Validate lower case
          if(!password.match(lowerCaseLetters)) {
            document.getElementById("not-valid-password").innerText = "Must be contain lowercase letter!";
            document.getElementById("not-valid-password").style.display = "block";
            btnRegister.style.opacity = 0.5;
          }
          
          // Validate capital letters
          else if(!password.match(upperCaseLetters)) {
            document.getElementById("not-valid-password").innerText = "Must be contain capital (uppercase) letter!";
            document.getElementById("not-valid-password").style.display = "block";
            btnRegister.style.opacity = 0.5;
          }

          // Validate numbers
          else if(!password.match(numbers)) {
            document.getElementById("not-valid-password").innerText = "Must be contain a number!";
            document.getElementById("not-valid-password").style.display = "block";
            btnRegister.style.opacity = 0.5;
          }
          
          // Validate length
          else if(password.length < 6) {
            document.getElementById("not-valid-password").innerText = "Must be at least 6 characters!";
            document.getElementById("not-valid-password").style.display = "block";
            btnRegister.style.opacity = 0.5;
          }
          else {
            document.getElementById("not-valid-password").style.display = "none";
            btnRegister.style.opacity = 1;
          }
        }
        else {
          document.getElementById("not-valid-password").style.display = "none";
          btnRegister.style.opacity = 1;
          return;
        }
        

    }

    // function
    function tambahUser() {
      if (inPassword.value != inConfirmPassword.value) return false;
      if (!isValidPassword(inPassword.value)) return false;
      // mengenali elemen html
      let inEmail = document.getElementById("input-email");
      
      // melihat value dari object inEmail
      //console.log(inEmail.value);
      //console.log(inPassword.value);

      // memeriksa apakah password sama dengan yang dikonfirmasi
      

      let newUser = {
        email: inEmail.value,
        password: inPassword.value
      }
      saveToStorage(newUser);
      // users.push(newUser);

      window.location.href = './dashboard.html';
      return false;
    }

    function saveToStorage(dataUser) {
      let stringDataUser = JSON.stringify(dataUser);
      localStorage.setItem('user', stringDataUser);
    }
  </script>
</body>

</html>